<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bobigos</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="../favicon.ico" />
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-REKT5H0GXW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-REKT5H0GXW');
  </script>
  
  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  
  <!-- Auth CSS -->
  <link rel="stylesheet" href="../css/auth.css" />
  
  <style>
    /* Updated minimal theme */
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.6;
      color: #000;
      background: #fff;
      margin: 0;
      padding: 0;
    }

    /* Remove all focus outlines */
    *:focus {
      outline: none !important;
    }

    .main-header {
      background: transparent;
      border-bottom: none;
      padding: 3.5rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .logo {
      position: absolute;
      left: 2rem;
      font-size: 1.5rem;
      font-weight: 700;
      color: #000;
      text-decoration: none;
      letter-spacing: -0.02em;
    }

    .main-nav {
      display: flex;
      gap: 2rem;
      align-items: center;
    }

    .main-nav a {
      color: #666;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s ease;
    }

    .main-nav a:hover,
    .main-nav a.active {
      color: #000;
      font-weight: 700;
      transition: all 0.2s ease;
    }

    .main-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* Category Header */
    .category-header {
      text-align: center;
      margin: 3rem 0;
    }

    .category-title {
      font-size: clamp(2rem, 4vw, 3rem);
      font-weight: 700;
      line-height: 1.1;
      margin: 0 0 1rem 0;
      letter-spacing: -0.03em;
      font-family: 'Lucida Console', monospace !important;
    }

    .category-subtitle {
      font-size: 1.25rem;
      color: #666;
      margin: 0 0 2rem 0;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Projects Grid */
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
      grid-auto-rows: masonry;
      align-items: start;
      justify-items: stretch;
    }

    /* Fallback for browsers that don't support masonry */
    @supports not (grid-template-rows: masonry) {
      .projects-grid {
        display: flex;
        flex-wrap: wrap;
        align-items: flex-start;
        align-content: flex-start;
        gap: 2rem;
      }
      
      .projects-grid > * {
        flex: 0 0 auto;
        width: calc(33.333% - 1.33rem);
        margin: 0;
        align-self: flex-start;
      }
      
      @media (max-width: 1024px) {
        .projects-grid > * {
          width: calc(50% - 1rem);
        }
      }
      
      @media (max-width: 768px) {
        .projects-grid > * {
          width: calc(50% - 1rem);
        }
      }
      
      @media (max-width: 480px) {
        .projects-grid > * {
          width: 100%;
        }
      }
    }

    .project-card {
      background: #fff;
      border: none;
      border-radius: 12px;
      padding: 2rem;
      transition: all 0.2s ease;
      position: relative;
      overflow: visible;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(0, 0, 0, 0.05);
      outline: none;
      break-inside: avoid;
      page-break-inside: avoid;
      align-self: start;
      margin: 0;
      box-sizing: border-box;
      width: 100%;
      max-width: 100%;
    }

    .project-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.08);
    }

    .project-header {
      margin-bottom: 1rem;
    }

    .project-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin: 0 0 0.75rem 0;
      color: #000;
    }

    .project-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 0.4rem;
    }

    .project-type-tag {
      display: inline-flex;
      align-items: center;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
      transition: all 0.2s ease;
      line-height: 1;
    }

    .social-handle-tag {
      display: inline-flex;
      align-items: center;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
      background: #e3f2fd;
      color: #1976d2;
      border: 1px solid #bbdefb;
      transition: all 0.2s ease;
      line-height: 1;
    }

    .project-type-tag:hover {
      transform: translateY(-2px);
    }

    /* Project type tag styles */
    .project-type-tag.startup {
      background: #ffffff !important;
      color: #000000 !important;
      border: 1px solid #000000 !important;
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1) !important;
    }

    .project-type-tag.small-biz {
      background: #000000 !important;
      color: #ffffff !important;
      border: 1px solid #000000 !important;
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1) !important;
    }

    .project-type-tag.business {
      background: #ffffff !important;
      color: #000000 !important;
      border: 1px solid #000000 !important;
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1) !important;
    }

    .project-type-tag.organization {
      background: rgba(156, 39, 176, 0.15);
      color: #9c27b0;
      border: 1px solid rgba(156, 39, 176, 0.3);
    }

    .project-type-tag.non-profit {
      background: rgba(74, 144, 226, 0.15);
      color: #4a90e2;
      border: 1px solid rgba(74, 144, 226, 0.3);
    }

    .project-type-tag.community {
      background: rgba(255, 215, 0, 0.15);
      color: #d4af37;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .project-description {
      color: #666;
      line-height: 1.6;
      margin: 0 0 1.5rem 0;
    }

    .our-niche-tile {
      background: #fff;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #f0f0f0;
    }

    .niche-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #666;
    }

    .niche-content {
      font-size: 0.85rem;
      color: #333;
      line-height: 1.4;
    }

    /* Impact Report Tile (for Fundraising & Goods) */
    .impact-report-tile {
      background: #fff;
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #f0f0f0;
    }

    .impact-report-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #666;
    }

    .impact-report-content {
      font-size: 0.85rem;
      color: #333;
      line-height: 1.4;
    }

    .project-actions {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }

    .apply-button {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 20px;
      padding: 0.6rem 2rem;
      text-decoration: none;
      color: #000;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.2s ease;
      display: inline-flex;
      flex-direction: row;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      min-width: 120px;
      justify-content: center;
    }

    .apply-button:hover {
      background: #e9ecef;
      border-color: #dee2e6;
      transform: translateY(-1px);
      text-decoration: none;
      color: #000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .apply-button .arrow {
      color: #000;
      font-size: 1.1rem;
      margin-left: 0.25rem;
    }

    /* Toggle Buttons */
    .view-toggle-container {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }

    .view-toggle-button {
      font-size: 1rem;
      font-weight: 600;
      padding: 0.75rem 2rem;
      border-radius: 50px;
      border: 2px solid #000;
      background: #fff;
      color: #000;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .view-toggle-button:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .view-toggle-button.active {
      background: #000;
      color: #fff;
    }

    /* Co-Host Category Filter */
    .co-host-filter-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      margin: 2rem 0;
      padding: 1.5rem;
      background: #f8f9fa;
      border-radius: 12px;
    }

    .filter-label {
      font-size: 1rem;
      font-weight: 600;
      color: #000;
    }

    .category-filter-select {
      font-size: 1rem;
      font-weight: 500;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      border: 2px solid #000;
      background: #fff;
      color: #000;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 250px;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .category-filter-select:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .category-filter-select:focus {
      outline: none;
      border-color: #3b82f6;
    }

    /* Idea Card Styles */
    .idea-card {
      background: #fff;
      border: 2px dashed #e0e0e0;
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.2s ease;
      position: relative;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05), 0 0 0 1px rgba(0, 0, 0, 0.03);
      outline: none;
      break-inside: avoid;
      page-break-inside: avoid;
      align-self: start;
      margin: 0;
      box-sizing: border-box;
      width: 100%;
      max-width: 100%;
    }

    .idea-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 24px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.08);
    }

    .idea-header {
      margin-bottom: 0.75rem;
    }

    .idea-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin: 0;
      color: #000;
    }

    .idea-description {
      color: #666;
      line-height: 1.6;
      margin: 0 0 1rem 0;
      font-size: 0.95rem;
    }

    .idea-mission {
      background: rgba(121, 183, 255, 0.08);
      border: 1px solid rgba(121, 183, 255, 0.2);
      border-radius: 12px;
      padding: 1rem;
      margin: 1rem 0;
    }

    .mission-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #1976d2;
    }

    .mission-content {
      font-size: 0.9rem;
      color: #333;
      line-height: 1.5;
      font-style: italic;
    }

    .idea-type-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.35rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
      background: rgba(121, 183, 255, 0.15);
      color: #1976d2;
      border: 1px solid rgba(121, 183, 255, 0.3);
      margin-top: 0.5rem;
    }

    /* Idea Number Badge */
    .idea-number-badge {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #000;
      color: #fff;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.9rem;
      z-index: 1;
    }

    /* Discord Discussion Notice */
    .discord-discussion-notice {
      background: rgba(88, 101, 242, 0.08);
      border: 1px solid rgba(88, 101, 242, 0.2);
      border-radius: 8px;
      padding: 0.75rem;
      margin-top: 1rem;
      font-size: 0.85rem;
      color: #333;
      line-height: 1.5;
    }

    .discord-discussion-notice strong {
      color: #5865F2;
      font-weight: 600;
    }

    /* Collaboration Section */
    .collaboration-section {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }

    .collaboration-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #000;
    }

    .collaborators-list {
      margin-bottom: 1rem;
    }

    .collaborator-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      background: rgba(121, 183, 255, 0.05);
      border-radius: 8px;
      margin-bottom: 0.5rem;
      font-size: 0.85rem;
    }

    .collaborator-contact {
      color: #1976d2;
      font-weight: 500;
    }

    .discord-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: #5865F2;
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-size: 0.85rem;
      font-weight: 600;
      transition: all 0.2s ease;
      margin-top: 0.5rem;
    }

    .discord-link:hover {
      background: #4752C4;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(88, 101, 242, 0.3);
    }

    .collaborate-button {
      background: linear-gradient(135deg, #79b7ff, #a8d8ff);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 0.6rem 1rem;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
      margin-top: 0.5rem;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .collaborate-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(121, 183, 255, 0.3);
      text-decoration: none;
      color: white;
    }

    /* Collaboration Form Modal */
    .collaboration-form-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1001;
      overflow-y: auto;
    }

    .collaboration-form-content {
      background: #fff;
      margin: 2rem auto;
      padding: 2rem;
      border-radius: 16px;
      max-width: 500px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      position: relative;
    }

    .collaboration-form-group {
      margin-bottom: 1.5rem;
    }

    .collaboration-form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #000;
      font-size: 0.9rem;
    }

    .collaboration-form-group input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      transition: border-color 0.2s ease;
    }

    .collaboration-form-group input:focus {
      outline: none;
      border-color: #79b7ff;
      box-shadow: 0 0 0 3px rgba(121, 183, 255, 0.1);
    }

    .collaboration-form-submit {
      background: #1a1a1a;
      color: white;
      padding: 0.75rem 2rem;
      border: none;
      border-radius: 50px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
    }

    .collaboration-form-submit:hover {
      transform: scale(1.02);
    }

    /* Share Idea Discord Tile - styled like "add your own" tile */
    .share-idea-discord-tile {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      border: 2px dashed #dee2e6;
      border-radius: 12px;
      padding: 2rem;
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: visible;
      break-inside: avoid;
      page-break-inside: avoid;
      align-self: start;
      margin: 0;
      box-sizing: border-box;
      width: 100%;
      max-width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 400px;
      cursor: default;
    }

    .share-idea-discord-tile:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .share-idea-discord-tile::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        45deg,
        transparent,
        rgba(255, 255, 255, 0.3),
        transparent,
        rgba(255, 255, 255, 0.1),
        transparent
      );
      animation: shimmer 3s linear infinite;
      transform: rotate(45deg);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .share-idea-discord-tile:hover::before {
      opacity: 1;
    }

    .share-idea-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      display: block;
      animation: pulse 2s ease-in-out infinite;
    }

    .share-idea-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #000;
      margin: 0 0 0.5rem 0;
      font-family: 'Lucida Console', monospace;
    }

    .share-idea-subtitle {
      color: #666;
      margin: 0 0 1rem 0;
      font-size: 1rem;
      line-height: 1.5;
    }

    .share-idea-form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-top: 1rem;
      text-align: left;
    }

    .share-idea-form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .share-idea-form-group label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #000;
    }

    .share-idea-form-group input,
    .share-idea-form-group textarea {
      padding: 0.6rem;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.9rem;
      font-family: inherit;
      transition: border-color 0.2s ease;
    }

    .share-idea-form-group input:focus,
    .share-idea-form-group textarea:focus {
      outline: none;
      border-color: #5865F2;
      box-shadow: 0 0 0 2px rgba(88, 101, 242, 0.1);
    }

    .share-idea-form-group textarea {
      min-height: 80px;
      resize: vertical;
    }

    .share-idea-button {
      font-size: 1rem;
      font-weight: 600;
      padding: 1rem 2rem;
      border-radius: 50px;
      border: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
      min-width: 160px;
      justify-content: center;
      background: #5865F2;
      color: white;
      position: relative;
      overflow: visible;
      z-index: 1;
      margin: 0 auto;
    }

    .share-idea-button::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -4px;
      background: linear-gradient(180deg, 
        transparent 0%, 
        transparent 40%, 
        rgba(88, 101, 242, 0.8) 60%, 
        rgba(88, 101, 242, 0.9) 70%, 
        rgba(88, 101, 242, 0.8) 80%, 
        rgba(88, 101, 242, 0.9) 90%, 
        rgba(88, 101, 242, 0.8) 95%, 
        rgba(88, 101, 242, 0.9) 100%);
      border-radius: 50px;
      z-index: -2;
      filter: blur(2px);
    }

    .share-idea-button::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #5865F2;
      border-radius: 50px;
      z-index: -1;
    }

    .share-idea-button:hover {
      transform: scale(1.05);
      text-decoration: none;
      color: white;
      background: #4752C4;
    }

    .share-idea-button:hover::after {
      background: #4752C4;
    }

    .share-idea-button .arrow {
      font-size: 1.1rem;
      transition: transform 0.2s ease;
    }

    .share-idea-button:hover .arrow {
      transform: translateX(3px);
    }

    /* Join Community Button - styled like back button with rainbow gradient */
    .join-community-button {
      font-size: 1rem;
      font-weight: 600;
      padding: 1rem 2rem;
      border-radius: 50px;
      border: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
      min-width: 160px;
      justify-content: center;
      background: #1a1a1a;
      color: white;
      position: relative;
      overflow: visible;
      z-index: 1;
      margin: 0 auto;
    }

    .join-community-button::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -4px;
      background: linear-gradient(180deg, 
        transparent 0%, 
        transparent 40%, 
        rgba(255, 107, 107, 0.8) 60%, 
        rgba(255, 167, 38, 0.8) 70%, 
        rgba(255, 235, 59, 0.8) 80%, 
        rgba(76, 175, 80, 0.8) 90%, 
        rgba(33, 150, 243, 0.8) 95%, 
        rgba(156, 39, 176, 0.8) 100%);
      border-radius: 50px;
      z-index: -2;
      filter: blur(2px);
    }

    .join-community-button::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #1a1a1a;
      border-radius: 50px;
      z-index: -1;
    }

    .join-community-button:hover {
      transform: scale(1.05);
      text-decoration: none;
      color: white;
    }

    .join-community-button .arrow {
      font-size: 1.1rem;
      transition: transform 0.2s ease;
    }

    .join-community-button:hover .arrow {
      transform: translateX(3px);
    }

    .discord-icon-svg {
      width: 24px;
      height: 24px;
      display: inline-block;
      vertical-align: middle;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
    }

    /* Idea Form Modal */
    .idea-form-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      overflow-y: auto;
    }

    .idea-form-content {
      background: #fff;
      margin: 2rem auto;
      padding: 2.5rem;
      border-radius: 16px;
      max-width: 600px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      position: relative;
    }

    .idea-form-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .idea-form-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #000;
      margin: 0;
    }

    .close-modal-button {
      background: #f8f9fa;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      cursor: pointer;
      font-size: 1.2rem;
      color: #666;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .close-modal-button:hover {
      background: #e9ecef;
      color: #000;
    }

    .idea-form-group {
      margin-bottom: 1.5rem;
    }

    .idea-form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #000;
      font-size: 0.95rem;
    }

    .idea-form-group input,
    .idea-form-group textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      transition: border-color 0.2s ease;
    }

    .idea-form-group input:focus,
    .idea-form-group textarea:focus {
      outline: none;
      border-color: #79b7ff;
      box-shadow: 0 0 0 3px rgba(121, 183, 255, 0.1);
    }

    .idea-form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .idea-form-submit {
      background: #1a1a1a;
      color: white;
      padding: 1rem 2rem;
      border: none;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
      margin-top: 1rem;
    }

    .idea-form-submit:hover {
      transform: scale(1.02);
    }

    /* Back button - styled like start imagining button with rainbow gradient */
    .back-button {
      font-size: 1rem;
      font-weight: 600;
      padding: 1rem 2rem;
      border-radius: 50px;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
      justify-content: center;
      background: #1a1a1a;
      color: white;
      position: relative;
      overflow: visible;
      z-index: 1;
      margin: 2rem auto;
      display: block;
      text-align: center;
      max-width: 200px;
    }

    .back-button::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -4px;
      background: linear-gradient(180deg, 
        transparent 0%, 
        transparent 40%, 
        rgba(255, 107, 107, 0.8) 60%, 
        rgba(255, 167, 38, 0.8) 70%, 
        rgba(255, 235, 59, 0.8) 80%, 
        rgba(76, 175, 80, 0.8) 90%, 
        rgba(33, 150, 243, 0.8) 95%, 
        rgba(156, 39, 176, 0.8) 100%);
      border-radius: 50px;
      z-index: -2;
      filter: blur(2px);
    }

    .back-button::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #1a1a1a;
      border-radius: 50px;
      z-index: -1;
    }

    .back-button:hover {
      transform: scale(1.05);
      color: white;
      text-decoration: none;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .header-container,
      .main-container {
        padding: 0 1rem;
      }

      .category-header {
        margin: 2rem 0;
      }

      .projects-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .view-toggle-container {
        flex-direction: column;
        align-items: stretch;
      }

      .view-toggle-button,
      .submit-idea-button {
        width: 100%;
        justify-content: center;
      }

      .idea-form-content {
        margin: 1rem;
        padding: 1.5rem;
      }

      .collaboration-form-content {
        margin: 1rem;
        padding: 1.5rem;
      }

      .discord-link {
        width: 100%;
        justify-content: center;
      }

      .collaboration-section {
        margin-top: 1rem;
        padding-top: 1rem;
      }
    }

    /* Grouped Bento Section (for Fundraising & Goods page) */
    .impact-metrics-section {
      display: none;
      margin: 3rem 0;
      padding: 0;
      width: 100%;
    }

    .category-icons-section {
      margin: 0;
      text-align: center;
    }

    .category-icons-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0;
    }

    /* Bento group containers - actual grid items */
    .bento-group {
      display: grid;
      background: #fff;
      border-radius: 16px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      padding: 1.5rem;
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .bento-group:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }

    /* Horizontal 3-bento group - spans 3 columns */
    .bento-group-horizontal-3 {
      grid-column: span 3;
      grid-template-columns: repeat(3, 1fr);
      gap: 0; /* No gap between grouped items */
    }

    .category-icon-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 2rem 1.5rem;
      border-radius: 16px;
      background: #fff;
      border: 1px solid #e5e7eb;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      width: 100%;
      height: 280px;
      margin: 0 auto;
      justify-content: space-between;
    }

    /* Items inside groups - remove individual borders/shadows, adjust padding */
    .bento-group .category-icon-item {
      border: none;
      box-shadow: none;
      border-radius: 0;
      padding: 1.5rem 1rem;
      background: transparent;
    }

    /* Items inside horizontal groups */
    .bento-group-horizontal-3 .category-icon-item {
      height: 280px;
    }

    /* Add dividers between items in groups */
    .bento-group-horizontal-3 .category-icon-item:not(:last-child) {
      border-right: 1px solid #e5e7eb;
    }

    .category-icon-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }

    /* Disable individual hover effects for items inside groups */
    .bento-group .category-icon-item:hover {
      transform: none;
      box-shadow: none;
      border-color: transparent;
    }

    .category-emoji {
      font-size: 5rem;
      margin-bottom: 1rem;
      display: block;
      line-height: 1;
    }

    .category-name {
      font-size: 1.2rem;
      font-weight: 600;
      color: #000;
      font-family: 'Lucida Console', monospace !important;
      text-align: center;
      line-height: 1.2;
      margin: 0.5rem 0 0.25rem 0;
    }

    .category-count {
      font-size: 0.9rem;
      font-weight: 400;
      color: #666;
      margin: 0 0 0.75rem 0;
      text-align: center;
    }

    .category-connect-button {
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 20px;
      padding: 0.6rem 1.5rem;
      text-decoration: none;
      color: #000;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.2s ease;
      display: inline-flex;
      flex-direction: row;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      min-width: 120px;
      justify-content: center;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    .category-connect-button:hover {
      background: #e9ecef;
      border-color: #dee2e6;
      transform: translateY(-1px);
      text-decoration: none;
      color: #000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .category-connect-button .arrow {
      color: #000;
      font-size: 1.1rem;
      margin-left: 0.25rem;
    }

    @media (max-width: 768px) {
      .category-icons-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .bento-group-horizontal-3 {
        grid-column: span 1;
        grid-template-columns: 1fr;
      }

      .bento-group-horizontal-3 .category-icon-item {
        height: auto;
        min-height: 280px;
      }

      .bento-group-horizontal-3 .category-icon-item:not(:last-child) {
        border-right: none;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 1.5rem;
        margin-bottom: 0;
      }

      .category-emoji {
        font-size: 4rem;
      }

      .category-name {
        font-size: 1.1rem;
      }

      .category-count {
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body class="category-page" id="top">
  <header class="main-header">
    <div class="header-container">
      <a href="../index.html" class="logo">
        <img src="../favicon.png" alt="bobigos" style="width: 32px; height: 32px; margin-right: 12px; vertical-align: middle;">
        bobigos
      </a>
      
      <nav class="main-nav">
        <a href="../index.html">Home</a>
        <a href="../network.html" class="active">Browse</a>
        <a href="../join-community.html" class="join-highlight">upload <span style="font-size: 0.9em; color: #000;">+</span></a>
      </nav>
    </div>
  </header>

  <main>
    <div class="main-container">
      <div class="category-header">
        <h1 class="category-title" id="category-title">Category Projects</h1>
        <p class="category-subtitle" id="category-subtitle">Explore projects in this category</p>
      </div>
      
      <!-- View Toggle Buttons -->
      <div class="view-toggle-container">
        <button class="view-toggle-button active" id="view-all-btn" onclick="switchView('all')">
          <span>Browse All</span>
        </button>
        <button class="view-toggle-button" id="view-startups-btn" onclick="switchView('startups')">
          <span>View Startups</span>
        </button>
        <button class="view-toggle-button" id="view-ideas-btn" onclick="switchView('ideas')">
          <span>Find Ideas</span>
        </button>
      </div>
      
      <!-- Category Filter for Co-Host Page -->
      <div class="co-host-filter-container" id="co-host-filter-container" style="display: none;">
        <label for="category-filter-select" class="filter-label">Filter by Category:</label>
        <select id="category-filter-select" class="category-filter-select" onchange="filterCoHostProjects(this.value)">
          <option value="">All Categories</option>
          <option value="Art">Art/Design/Crafts</option>
          <option value="Beauty">Beauty</option>
          <option value="Business">Business/Entrepreneurship</option>
          <option value="Computer Science">Computer Science</option>
          <option value="Education">Education</option>
          <option value="Engineering">Engineering</option>
          <option value="Environment">Environment</option>
          <option value="Film">Film/Performing Arts</option>
          <option value="Finance">Finance</option>
          <option value="Food">Food/Drink</option>
          <option value="Health">Health/Medicine</option>
          <option value="Law">Law/Political Science</option>
          <option value="Psychology">Psychology</option>
          <option value="Technology">Technology</option>
          <option value="Writing">Literature/Writing</option>
          <option value="Tutoring">Tutoring/Education</option>
        </select>
      </div>
      
      <a href="../network.html" class="back-button">
        <span>Go Back</span>
        <span>â†’</span>
      </a>

      <!-- Grouped Bento Section (for Fundraising & Goods page) -->
      <div class="impact-metrics-section" id="impact-metrics-section">
        <div class="category-icons-section">
          <div class="category-icons-grid">
            <!-- Top 3 bentos grouped horizontally (3-bento-long) -->
            <div class="bento-group bento-group-horizontal-3">
              <div class="category-icon-item" onclick="window.location.href='category-template.html?category=art'">
                <div class="category-emoji">ðŸ’¿</div>
                <div class="category-name">Art/Design/Crafts</div>
                <div class="category-count">Loading...</div>
                <a href="category-template.html?category=art" class="category-connect-button" onclick="event.stopPropagation();">
                  <span>Explore</span>
                  <span class="arrow">â†’</span>
                </a>
              </div>
              <div class="category-icon-item" onclick="window.location.href='category-template.html?category=beauty'">
                <div class="category-emoji">ðŸ«§</div>
                <div class="category-name">Beauty</div>
                <div class="category-count">Loading...</div>
                <a href="category-template.html?category=beauty" class="category-connect-button" onclick="event.stopPropagation();">
                  <span>Explore</span>
                  <span class="arrow">â†’</span>
                </a>
              </div>
              <div class="category-icon-item" onclick="window.location.href='category-template.html?category=business'">
                <div class="category-emoji">ðŸ“±</div>
                <div class="category-name">Business/Entrepreneurship</div>
                <div class="category-count">Loading...</div>
                <a href="category-template.html?category=business" class="category-connect-button" onclick="event.stopPropagation();">
                  <span>Explore</span>
                  <span class="arrow">â†’</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="projects-grid" id="projects-grid">
        <!-- Projects/Ideas will be loaded here by JavaScript -->
      </div>
    </div>
  </main>

  <!-- Collaboration Form Modal -->
  <div id="collaboration-form-modal" class="collaboration-form-modal">
    <div class="collaboration-form-content">
      <div class="idea-form-header">
        <h2 class="idea-form-title">Join as Collaborator</h2>
        <button class="close-modal-button" onclick="closeCollaborationForm()">Ã—</button>
      </div>
      <form id="collaboration-form" action="https://usebasin.com/f/264e81003939" method="POST">
        <input type="hidden" name="submission-type" value="collaborator">
        <input type="hidden" name="idea-id" id="collaboration-idea-id">
        <input type="hidden" name="category" id="collaboration-category-hidden">
        
        <div class="collaboration-form-group">
          <label for="collaborator-name">Your Name</label>
          <input type="text" id="collaborator-name" name="collaborator-name" placeholder="Your name" required>
        </div>

        <div class="collaboration-form-group">
          <label for="collaborator-contact">Your Contact (IG Handle or Email)</label>
          <input type="text" id="collaborator-contact" name="collaborator-contact" placeholder="@yourhandle or your@email.com" required>
        </div>

        <button type="submit" class="collaboration-form-submit">Join as Collaborator</button>
      </form>
    </div>
  </div>

  <!-- Idea Submission Form Modal -->
  <div id="idea-form-modal" class="idea-form-modal">
    <div class="idea-form-content">
      <div class="idea-form-header">
        <h2 class="idea-form-title">Share Your Startup Idea</h2>
        <button class="close-modal-button" onclick="closeIdeaForm()">Ã—</button>
      </div>
      <form id="idea-submission-form" action="https://usebasin.com/f/264e81003939" method="POST">
        <input type="hidden" name="submission-type" value="idea">
        <input type="hidden" name="category" id="idea-category-hidden">
        
        <div class="idea-form-group">
          <label for="idea-name">Your Name or Handle</label>
          <input type="text" id="idea-name" name="idea-name" placeholder="Your name or @handle" required>
        </div>

        <div class="idea-form-group">
          <label for="idea-title">Idea Title</label>
          <input type="text" id="idea-title" name="idea-title" placeholder="A catchy name for your idea" required>
        </div>

        <div class="idea-form-group">
          <label for="idea-description">What's Your Idea?</label>
          <textarea id="idea-description" name="idea-description" placeholder="Describe your startup idea or mission statement..." required></textarea>
        </div>

        <div class="idea-form-group">
          <label for="idea-mission">Mission Statement (Optional)</label>
          <textarea id="idea-mission" name="idea-mission" placeholder="What's the mission or vision behind your idea?"></textarea>
        </div>

        <div class="idea-form-group">
          <label for="idea-email">Email</label>
          <input type="email" id="idea-email" name="email" placeholder="your@email.com" required>
        </div>

        <div class="idea-form-group">
          <label for="idea-discord">Discord Server Link (Optional)</label>
          <input type="url" id="idea-discord" name="discord-link" placeholder="https://discord.gg/your-server">
          <small style="color: #666; font-size: 0.85rem; margin-top: 0.25rem; display: block;">Add a Discord link for people to collaborate on this idea</small>
        </div>

        <div class="idea-form-group">
          <label for="idea-contact">Your Contact Info (IG or Email)</label>
          <input type="text" id="idea-contact" name="contact-info" placeholder="@yourhandle or your@email.com" required>
          <small style="color: #666; font-size: 0.85rem; margin-top: 0.25rem; display: block;">This will be shown so people can reach out to collaborate</small>
        </div>

        <button type="submit" class="idea-form-submit">Submit Idea</button>
      </form>
    </div>
  </div>

  <script>
    // Get category from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const category = urlParams.get('category');
    let currentView = 'all'; // 'all', 'startups', or 'ideas'
    let allCoHostProjects = []; // Store all projects for filtering
    
    if (category) {
      // Check if this is the co-host view (engineering category with co-host parameter)
      const isCoHost = urlParams.get('co-host') === 'true' || urlParams.get('co-host') === '1';
      
      // If it's engineering category AND co-host parameter is present, load all projects
      if (category === 'engineering' && isCoHost) {
        document.getElementById('category-title').textContent = 'Find a Co-Host';
        document.getElementById('category-subtitle').textContent = 'Browse all projects across all categories to find your perfect co-host';
        document.getElementById('idea-category-hidden').value = category;
        // Hide view toggle buttons for co-host
        const viewToggleContainer = document.querySelector('.view-toggle-container');
        if (viewToggleContainer) {
          viewToggleContainer.style.display = 'none';
        }
        // Show category filter for co-host
        createCategoryFilter();
        loadAllProjects();
      } else if (category === 'custom-ideas') {
        // Special handling for custom ideas
        document.getElementById('category-title').textContent = 'Post a Custom Idea';
        document.getElementById('category-subtitle').textContent = 'Share your startup ideas and connect with potential collaborators';
        document.getElementById('idea-category-hidden').value = 'custom-ideas';
        // Hide view toggle buttons for custom ideas
        const viewToggleContainer = document.querySelector('.view-toggle-container');
        if (viewToggleContainer) {
          viewToggleContainer.style.display = 'none';
        }
        // Load custom ideas
        loadCustomIdeas();
      } else {
        // Update page title and header
        document.getElementById('category-title').textContent = category.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
        document.getElementById('category-subtitle').textContent = `Explore ${category.replace(/-/g, ' ')} projects and connect with like-minded entrepreneurs`;
        
        // Set category in hidden input for idea form
        document.getElementById('idea-category-hidden').value = category;
        
        // Show impact metrics section for Fundraising & Goods (law category)
        if (category === 'law') {
          const impactSection = document.getElementById('impact-metrics-section');
          if (impactSection) {
            impactSection.style.display = 'block';
          }
        }
        
        // Load all (startups and ideas) by default
        loadCategoryAll(category);
      }
    }

    // List of all category names (excluding ideas-* and all-posts)
    const allCategories = [
      'art', 'beauty', 'business', 'computer-science', 'education', 
      'engineering', 'environment', 'film', 'finance', 'food-drink', 
      'health', 'law', 'psychology', 'technology', 'writing'
    ];

    // Helper function to get the correct JSON filename for a category
    function getCategoryJsonFile(category) {
      if (category === 'law') {
        return 'fundraising-and-goods.json';
      }
      return `${category}.json`;
    }

    // Helper function to get the correct ideas JSON filename for a category
    function getCategoryIdeasJsonFile(category) {
      if (category === 'law') {
        return 'ideas-fundraising-and-goods.json';
      }
      return `ideas-${category}.json`;
    }

    async function loadAllProjects() {
      try {
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = ''; // Clear existing content
        
        // Add join community tile first
        const joinTile = createJoinCommunityTile();
        projectsGrid.appendChild(joinTile);
        
        // List of all category names (excluding ideas-* and all-posts)
        const allCategories = [
          'art', 'beauty', 'business', 'computer-science', 'education', 
          'engineering', 'environment', 'film', 'finance', 'food-drink', 
          'health', 'law', 'psychology', 'technology', 'writing'
        ];
        
        // Load all category JSON files in parallel
        const categoryPromises = allCategories.map(cat => 
          fetch(`categories/${cat}.json`)
            .then(response => response.ok ? response.json() : [])
            .catch(() => [])
        );
        
        const allCategoryData = await Promise.all(categoryPromises);
        
        // Flatten and deduplicate projects by title
        const projectsMap = new Map();
        allCategoryData.forEach(categoryProjects => {
          if (Array.isArray(categoryProjects)) {
            categoryProjects.forEach(project => {
              if (project && project.title) {
                // Use title as unique key for deduplication
                const key = project.title.toLowerCase().trim();
                if (!projectsMap.has(key)) {
                  projectsMap.set(key, project);
                }
              }
            });
          }
        });
        
        // Convert map values to array
        const uniqueProjects = Array.from(projectsMap.values());
        
        // Store projects globally for filtering
        allCoHostProjects = uniqueProjects;
        
        if (uniqueProjects.length === 0) {
          // Still show the join tile even if no projects
          return;
        }
        
        // Display all unique projects
        displayCoHostProjects(uniqueProjects);
        
        // Initialize masonry layout for browsers that don't support CSS Grid masonry
        if (!CSS.supports('grid-template-rows', 'masonry')) {
          setTimeout(() => {
            initializeMasonryFallback();
          }, 100);
        }
      } catch (error) {
        console.error('Error loading all projects:', error);
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = '';
        const joinTile = createJoinCommunityTile();
        projectsGrid.appendChild(joinTile);
        projectsGrid.innerHTML += '<p style="text-align: center; color: #666; grid-column: 1 / -1;">Error loading projects. Please try again.</p>';
      }
    }

    function switchView(view) {
      if (!category) {
        console.error('Category not found');
        return;
      }
      
      // Special handling for co-host
      const isCoHost = urlParams.get('co-host') === 'true';
      if (isCoHost && category === 'engineering') {
        // Co-host only shows all projects, so disable view switching or just reload
        loadAllProjects();
        return;
      }
      
      // Special handling for custom-ideas - only shows ideas
      if (category === 'custom-ideas') {
        loadCustomIdeas();
        return;
      }
      
      currentView = view;
      
      // Update button states
      const allBtn = document.getElementById('view-all-btn');
      const startupsBtn = document.getElementById('view-startups-btn');
      const ideasBtn = document.getElementById('view-ideas-btn');
      
      // Remove active class from all buttons
      allBtn.classList.remove('active');
      startupsBtn.classList.remove('active');
      ideasBtn.classList.remove('active');
      
      if (view === 'all') {
        allBtn.classList.add('active');
        loadCategoryAll(category);
      } else if (view === 'startups') {
        startupsBtn.classList.add('active');
        loadCategoryProjects(category);
      } else {
        ideasBtn.classList.add('active');
        loadCategoryIdeas(category);
      }
    }

    // Function to show category filter for co-host page
    function createCategoryFilter() {
      const filterContainer = document.getElementById('co-host-filter-container');
      if (filterContainer) {
        filterContainer.style.display = 'flex';
      }
    }

    // Function to display projects (used for filtering)
    function displayCoHostProjects(projects) {
      const projectsGrid = document.getElementById('projects-grid');
      // Clear existing projects but keep the join tile
      const joinTile = projectsGrid.querySelector('.share-idea-discord-tile');
      projectsGrid.innerHTML = '';
      if (joinTile) {
        projectsGrid.appendChild(joinTile);
      } else {
        // Re-add join tile if it doesn't exist
        const newJoinTile = createJoinCommunityTile();
        projectsGrid.appendChild(newJoinTile);
      }
      
      // Display filtered projects
      projects.forEach(project => {
        const projectCard = createProjectCard(project);
        projectsGrid.appendChild(projectCard);
      });
      
      // Initialize masonry layout
      if (!CSS.supports('grid-template-rows', 'masonry')) {
        setTimeout(() => {
          initializeMasonryFallback();
        }, 100);
      }
    }

    // Function to filter projects by category
    function filterCoHostProjects(selectedCategory) {
      if (!selectedCategory || selectedCategory === '') {
        // Show all projects
        displayCoHostProjects(allCoHostProjects);
        return;
      }
      
      // Map filter values to actual category values in projects
      const categoryMapping = {
        'Art': ['Art', 'Design', 'Graphic Design', 'Crafts', 'Photography', 'Product Design'],
        'Beauty': ['Beauty', 'Hairstyling', 'Barber'],
        'Business': ['Business', 'Entrepreneurship', 'Marketing', 'Sales', 'Consulting', 'Operations', 'Human Resources'],
        'Computer Science': ['Computer Science', 'Data', 'STEM'],
        'Education': ['Education'],
        'Engineering': ['Engineering'],
        'Environment': ['Environment', 'Landscaping'],
        'Film': ['Film', 'Performing Arts'],
        'Finance': ['Finance'],
        'Food': ['Food', 'Drink', 'Restaurants'],
        'Health': ['Health', 'Medicine'],
        'Law': ['Law', 'Political Science'],
        'Psychology': ['Psychology'],
        'Technology': ['Technology'],
        'Writing': ['Writing', 'Literature'],
        'Tutoring': ['Tutoring', 'Education']
      };
      
      const categoriesToMatch = categoryMapping[selectedCategory] || [selectedCategory];
      
      // Filter projects that match any of the mapped categories
      const filteredProjects = allCoHostProjects.filter(project => {
        if (!project.category) return false;
        const projectCategory = project.category.toLowerCase();
        return categoriesToMatch.some(cat => 
          projectCategory.includes(cat.toLowerCase()) || 
          cat.toLowerCase().includes(projectCategory)
        );
      });
      
      displayCoHostProjects(filteredProjects);
    }

    async function loadCategoryAll(category) {
      try {
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = ''; // Clear existing content
        
        // Get the correct JSON filenames
        const projectsFile = getCategoryJsonFile(category);
        const ideasFile = getCategoryIdeasJsonFile(category);
        
        // Load both startups and ideas
        const [projectsResponse, ideasResponse] = await Promise.allSettled([
          fetch(`categories/${projectsFile}`),
          fetch(`categories/${ideasFile}`)
        ]);
        
        // Add join community tile first (for startups) - skip for fundraising & goods
        if (category !== 'law') {
          const joinTile = createJoinCommunityTile();
          projectsGrid.appendChild(joinTile);
          
          // Add Discord tile (for ideas) - skip for fundraising & goods
          const discordTile = createShareIdeaDiscordTile();
          projectsGrid.appendChild(discordTile);
        }
        
        // Load and display startups
        let projects = [];
        if (projectsResponse.status === 'fulfilled' && projectsResponse.value.ok) {
          projects = await projectsResponse.value.json();
        }
        
        projects.forEach(project => {
          const projectCard = createProjectCard(project);
          projectsGrid.appendChild(projectCard);
        });
        
        // Load and display ideas
        let ideas = [];
        if (ideasResponse.status === 'fulfilled' && ideasResponse.value.ok) {
          ideas = await ideasResponse.value.json();
        }
        
        ideas.forEach((idea, index) => {
          const ideaCard = createIdeaCard(idea, `idea-${category}-${index}`, index + 1, category);
          projectsGrid.appendChild(ideaCard);
        });
        
        // Initialize masonry layout for browsers that don't support CSS Grid masonry
        if (!CSS.supports('grid-template-rows', 'masonry')) {
          setTimeout(() => {
            initializeMasonryFallback();
          }, 100);
        }
      } catch (error) {
        console.error('Error loading category content:', error);
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = '<p style="text-align: center; color: #666; grid-column: 1 / -1;">Error loading content. Please try again.</p>';
      }
    }

    async function loadCategoryProjects(category) {
      try {
        const projectsFile = getCategoryJsonFile(category);
        const response = await fetch(`categories/${projectsFile}`);
        const projects = await response.json();
        
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = ''; // Clear existing content
        
        // Add join community tile as first item - skip for fundraising & goods
        if (category !== 'law') {
          const joinTile = createJoinCommunityTile();
          projectsGrid.appendChild(joinTile);
        }
        
        if (!projects || projects.length === 0) {
          // Still show the join tile even if no projects (unless it's fundraising & goods)
          return;
        }
        
        projects.forEach(project => {
          const projectCard = createProjectCard(project);
          projectsGrid.appendChild(projectCard);
        });
        
        // Initialize masonry layout for browsers that don't support CSS Grid masonry
        if (!CSS.supports('grid-template-rows', 'masonry')) {
          setTimeout(() => {
            initializeMasonryFallback();
          }, 100);
        }
      } catch (error) {
        console.error('Error loading category projects:', error);
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = '';
        // Still show join tile even if loading fails - skip for fundraising & goods
        if (category !== 'law') {
          const joinTile = createJoinCommunityTile();
          projectsGrid.appendChild(joinTile);
        }
      }
    }

    async function loadCustomIdeas() {
      try {
        const response = await fetch(`categories/custom-ideas.json`);
        const ideas = await response.json();
        
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = ''; // Clear existing content
        
        // Add Discord tile as first item (pinned)
        const discordTile = createShareIdeaDiscordTile();
        projectsGrid.appendChild(discordTile);
        
        if (!ideas || !Array.isArray(ideas) || ideas.length === 0) {
          // If no ideas, still show the Discord tile
          return;
        }
        
        ideas.forEach((idea, index) => {
          const ideaCard = createIdeaCard(idea, `idea-custom-${index}`, index + 1, 'custom-ideas');
          projectsGrid.appendChild(ideaCard);
        });
        
        // Initialize masonry layout for browsers that don't support CSS Grid masonry
        if (!CSS.supports('grid-template-rows', 'masonry')) {
          setTimeout(() => {
            initializeMasonryFallback();
          }, 100);
        }
      } catch (error) {
        console.error('Error loading custom ideas:', error);
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = '';
        // Still show Discord tile even if loading fails
        const discordTile = createShareIdeaDiscordTile();
        projectsGrid.appendChild(discordTile);
      }
    }

    async function loadCategoryIdeas(category) {
      try {
        const ideasFile = getCategoryIdeasJsonFile(category);
        const response = await fetch(`categories/${ideasFile}`);
        const ideas = await response.json();
        
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = ''; // Clear existing content
        
        // Add Discord tile as first item - skip for fundraising & goods
        if (category !== 'law') {
          const discordTile = createShareIdeaDiscordTile();
          projectsGrid.appendChild(discordTile);
        }
        
        if (!ideas || ideas.length === 0) {
          // If no ideas, still show the Discord tile (unless it's fundraising & goods)
          return;
        }
        
        ideas.forEach((idea, index) => {
          const ideaCard = createIdeaCard(idea, `idea-${category}-${index}`, index + 1, category);
          projectsGrid.appendChild(ideaCard);
        });
        
        // Initialize masonry layout for browsers that don't support CSS Grid masonry
        if (!CSS.supports('grid-template-rows', 'masonry')) {
          setTimeout(() => {
            initializeMasonryFallback();
          }, 100);
        }
      } catch (error) {
        console.error('Error loading category ideas:', error);
        const projectsGrid = document.getElementById('projects-grid');
        projectsGrid.innerHTML = '';
        // Still show Discord tile even if loading fails - skip for fundraising & goods
        if (category !== 'law') {
          const discordTile = createShareIdeaDiscordTile();
          projectsGrid.appendChild(discordTile);
        }
      }
    }

    function createShareIdeaDiscordTile() {
      const tile = document.createElement('div');
      tile.className = 'share-idea-discord-tile';
      
      // Get category from URL
      const urlParams = new URLSearchParams(window.location.search);
      const category = urlParams.get('category') || '';
      
      tile.innerHTML = `
        <span class="share-idea-icon">
          <svg class="discord-icon-svg" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.0157 50.6034 51.233 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z" fill="currentColor"/>
          </svg>
        </span>
        <h3 class="share-idea-title">share your idea</h3>
        <p class="share-idea-subtitle">submit your startup idea to share with the community</p>
        <form class="share-idea-form" id="share-idea-form-${Date.now()}" action="https://usebasin.com/f/264e81003939" method="POST">
          <input type="hidden" name="submission-type" value="idea">
          <input type="hidden" name="category" value="${category}">
          
          <div class="share-idea-form-group">
            <label for="idea-title-input">Title for Idea</label>
            <input type="text" id="idea-title-input" name="idea-title" placeholder="Your idea title" required>
          </div>
          
          <div class="share-idea-form-group">
            <label for="idea-description-input">Idea</label>
            <textarea id="idea-description-input" name="idea-description" placeholder="Describe your startup idea..." required></textarea>
          </div>
          
          <div class="share-idea-form-group">
            <label for="idea-email-input">Email</label>
            <input type="email" id="idea-email-input" name="email" placeholder="your@email.com" required>
          </div>
          
          <button type="submit" class="share-idea-button">
            <span>Submit Idea</span>
            <span class="arrow">â†’</span>
          </button>
        </form>
      `;
      
      // Add form submission handler
      const form = tile.querySelector('form');
      if (form) {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Validate form
          const title = this.querySelector('[name="idea-title"]').value.trim();
          const description = this.querySelector('[name="idea-description"]').value.trim();
          const email = this.querySelector('[name="email"]').value.trim();
          
          if (!title || !description || !email) {
            alert('Please fill in all fields');
            return;
          }
          
          // Show success message
          alert('Thank you! Your idea has been submitted.');
          
          // Submit the form
          this.submit();
        });
      }
      
      return tile;
    }

    function createJoinCommunityTile() {
      const tile = document.createElement('div');
      tile.className = 'share-idea-discord-tile';
      
      tile.innerHTML = `
        <span class="share-idea-icon">Ëšà­¨à­§â‹†.Ëš</span>
        <h3 class="share-idea-title">add your own</h3>
        <p class="share-idea-subtitle">upload your established startup or small business to showcase to the community</p>
        <a href="../join-community.html" class="join-community-button">
          <span>+ join bobigos</span>
          <span class="arrow">â†’</span>
        </a>
      `;
      
      return tile;
    }

    function createProjectCard(project) {
      const card = document.createElement('div');
      card.className = 'project-card';
      
      // Check if this is the fundraising-and-goods category
      const isFundraisingGoods = category === 'law';
      
      // Determine tag to display
      let tagDisplay = '';
      if (isFundraisingGoods && project.tag) {
        tagDisplay = `<div class="project-type-tag">${project.tag}</div>`;
      } else {
        tagDisplay = `<div class="project-type-tag ${project.type ? project.type.toLowerCase().replace(/\s+/g, '-') : 'startup'}">${project.type || 'Startup'}</div>`;
      }
      
      // Determine niche/impact report section
      let nicheSection = '';
      if (isFundraisingGoods && project.niche) {
        nicheSection = `
        <div class="impact-report-tile">
          <div class="impact-report-header">
            <span class="niche-icon">â˜•ï¸</span>
            <span class="niche-title">Impact Report</span>
          </div>
          <div class="impact-report-content">${project.niche}</div>
        </div>
        `;
      } else if (project.niche) {
        nicheSection = `
        <div class="our-niche-tile">
          <div class="niche-header">
            <span class="niche-icon">â˜•ï¸</span>
            <span class="niche-title">Our Niche</span>
          </div>
          <div class="niche-content">${project.niche}</div>
        </div>
        `;
      }
      
      // Determine button text
      const buttonText = isFundraisingGoods ? 'Request' : 'Connect';
      
      card.innerHTML = `
        <div class="project-header">
          <h3 class="project-title">${project.title}</h3>
          <div class="project-tags">
            ${tagDisplay}
            ${project.socialHandle ? `<div class="social-handle-tag">@${project.socialHandle}</div>` : ''}
          </div>
        </div>
        <p class="project-description">${project.description}</p>
        ${nicheSection}
        ${project.connectionLink && project.connectionLink !== '#' ? `
        <div class="project-actions">
          <a href="${project.connectionLink}" class="apply-button" target="_blank">
            <span>${buttonText}</span>
            <span class="arrow">â†’</span>
          </a>
        </div>
        ` : ''}
      `;
      
      return card;
    }

    function createIdeaCard(idea, ideaId, ideaNumber, category) {
      const card = document.createElement('div');
      card.className = 'idea-card';
      const finalIdeaId = ideaId || `idea-${Date.now()}`;
      card.setAttribute('data-idea-id', finalIdeaId);
      
      const discordLink = idea['discord-link'] || idea.discord || '';
      const collaborators = idea.collaborators || [];
      
      // Format category name for display (capitalize and replace hyphens)
      const categoryDisplay = category ? category.split('-').map(word => 
        word.charAt(0).toUpperCase() + word.slice(1)
      ).join(' ') : 'Network';
      
      card.innerHTML = `
        ${ideaNumber ? `<div class="idea-number-badge">${ideaNumber}</div>` : ''}
        <div class="idea-header">
          <h3 class="idea-title">${idea.title || idea['idea-title']}</h3>
        </div>
        <p class="idea-description">${idea.description || idea['idea-description']}</p>
        
        ${ideaNumber ? `
        <div class="discord-discussion-notice">
          <strong>ðŸ’¬ Discord Discussion:</strong> Please title your Discord thread as "<strong>${categoryDisplay} Idea #${ideaNumber}</strong>" so others can easily find and join the discussion.
        </div>
        ` : ''}
        
        <div class="collaboration-section">
          <div class="collaboration-header">
            <span>Looking for Collaborators</span>
          </div>
          
          ${collaborators.length > 0 ? `
          <div class="collaborators-list">
            ${collaborators.map(collab => `
              <div class="collaborator-item">
                <span class="collaborator-contact">${collab.contact || collab}</span>
              </div>
            `).join('')}
          </div>
          ` : ''}
          
          <a href="https://discord.gg/ndktHfFUnJ" target="_blank" class="collaborate-button">
            Add Yourself as a Collaborator
          </a>
        </div>
      `;
      
      return card;
    }

    function openIdeaForm() {
      document.getElementById('idea-form-modal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeIdeaForm() {
      document.getElementById('idea-form-modal').style.display = 'none';
      document.body.style.overflow = 'auto';
      document.getElementById('idea-submission-form').reset();
    }

    // Close modal when clicking outside
    document.getElementById('idea-form-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeIdeaForm();
      }
    });

    // Handle idea form submission
    document.getElementById('idea-submission-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Show success message
      alert('Thank you! Your idea has been submitted and will be reviewed.');
      
      // Reset form and close modal
      this.reset();
      closeIdeaForm();
      
      // Submit to form endpoint (you can customize this)
      this.submit();
    });

    // Collaboration form functions
    function openCollaborationForm(ideaId) {
      document.getElementById('collaboration-idea-id').value = ideaId;
      document.getElementById('collaboration-category-hidden').value = category || '';
      document.getElementById('collaboration-form-modal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeCollaborationForm() {
      document.getElementById('collaboration-form-modal').style.display = 'none';
      document.body.style.overflow = 'auto';
      document.getElementById('collaboration-form').reset();
    }

    // Close collaboration modal when clicking outside
    document.getElementById('collaboration-form-modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeCollaborationForm();
      }
    });

    // Handle collaboration form submission
    document.getElementById('collaboration-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Show success message
      alert('Thank you! Your collaboration request has been submitted. The idea creator will be notified.');
      
      // Reset form and close modal
      this.reset();
      closeCollaborationForm();
      
      // Submit to form endpoint
      this.submit();
    });

    // Fallback masonry implementation for browsers without CSS Grid masonry support
    function initializeMasonryFallback() {
      const grid = document.getElementById('projects-grid');
      if (!grid) return;
      
      const items = Array.from(grid.children);
      if (items.length === 0) return;
      
      // Reset positioning and ensure items are visible for measurement
      items.forEach(item => {
        item.style.position = 'static';
        item.style.transform = 'none';
        item.style.opacity = '0';
        item.style.margin = '0';
        item.style.width = 'auto';
      });
      
      // Force a reflow to ensure measurements are accurate
      grid.offsetHeight;
      
      // Calculate column count based on available width
      const containerWidth = grid.offsetWidth;
      const itemWidth = 300; // minmax width
      const gap = 32; // 2rem in pixels
      const columns = Math.max(1, Math.floor((containerWidth + gap) / (itemWidth + gap)));
      
      // Initialize column heights array
      const columnHeights = new Array(columns).fill(0);
      const columnWidth = (containerWidth - (gap * (columns - 1))) / columns;
      
      // Position each item in the shortest column
      items.forEach((item, index) => {
        // Find the shortest column
        const shortestColumn = columnHeights.indexOf(Math.min(...columnHeights));
        
        // Calculate position with proper gap spacing
        const x = shortestColumn * (columnWidth + gap);
        const y = columnHeights[shortestColumn];
        
        // Position the item
        item.style.position = 'absolute';
        item.style.left = `${x}px`;
        item.style.top = `${y}px`;
        item.style.width = `${columnWidth}px`;
        item.style.transform = 'none';
        item.style.opacity = '1';
        item.style.margin = '0';
        
        // Update column height with gap
        columnHeights[shortestColumn] += item.offsetHeight + gap;
      });
      
      // Set container height and positioning
      grid.style.height = `${Math.max(...columnHeights)}px`;
      grid.style.position = 'relative';
    }
    
    // Re-run masonry on window resize
    window.addEventListener('resize', () => {
      if (!CSS.supports('grid-template-rows', 'masonry')) {
        setTimeout(initializeMasonryFallback, 100);
      }
    });
  </script>
</body>
</html>
